<div class="form-container rounded-2xl p-8 max-w-4xl w-full">
  <h2 class="text-3xl font-bold text-black mb-8 text-center">Create New Note</h2>

  <form [formGroup]="createNoteForm" (ngSubmit)="onCreateNote()">
    <!-- Title Input -->
    <div class="mb-6">
      <label for="title" class="floating-label block mb-2 text-sm font-medium text-shadow-black">Title</label>
      <input type="text"
             id="title"
             name="title"
             formControlName="title"
             class="input-field w-full p-4 text-black text-sm rounded-xl focus:outline-none"
             placeholder="Enter your note title..."
             required>
    </div>

    <!-- Tag and Category Selection -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8" style="position: relative;">
      <!-- Tag Selection -->
      <div class="select-container tag-selector-container">
        <label class="floating-label">
          <span class="tag-icon">üè∑Ô∏è</span>
          Tags
        </label>

        <!-- Custom Multi-Select Dropdown -->
        <div class="custom-multi-select" (click)="toggleTagDropdown()">
          <div class="selected-tags-display">
            <div class="selected-tags-container">
              <!-- Show selected tags as chips -->
              @if (selectedTags.length > 0) {
                @for (tag of selectedTags; track tag.id) {
                  <span class="tag-chip">
              {{ tag.name }}
                    <button type="button"
                            class="tag-remove-btn"
                            (click)="removeTag($event, tag.id)">√ó</button>
            </span>
                }
              } @else {
                <span class="placeholder-text">Choose your tags...</span>
              }
            </div>
            <span class="dropdown-arrow" [class.rotated]="isTagDropdownOpen">‚ñº</span>
          </div>

          <!-- Dropdown Options -->
          @if (isTagDropdownOpen) {
            <div class="dropdown-options">
              @for (tag of tagList; track tag.id) {
                <label class="tag-option">
                  <input type="checkbox"
                         [checked]="isTagSelected(tag.id)"
                         (change)="onTagToggle(tag.id, $event)">
                  <span class="checkmark"></span>
                  {{ tag.name }}
                </label>
              }
            </div>
          }
        </div>
      </div>


      <!-- Category Selection -->
      <div class="select-container">
        <label for="category" class="floating-label">
          <span class="category-icon">üìÅ</span>
          Category
        </label>
        <div class="custom-select">
          <select id="category"
                  name="category"
                  formControlName="categoryId">
            <option value="">Choose a category...</option>
            @for (category of categoryList; track $index){
              <option [value]="category.id">{{category.name}}</option>
            }
          </select>
        </div>
      </div>
    </div> <!-- ‚úÖ Closed the grid container -->

    <!-- Status Selection - Full Width -->
    <div class="mb-8">
      <div class="select-container">
        <label for="status" class="floating-label">
          <span class="status-icon">üìä</span>
          Status
        </label>
        <div class="custom-select">
          <select id="status"
                  name="status"
                  formControlName="status">
            <option value="">Choose status...</option>
            <option [value]="noteStatus.ACTIVE">{{noteStatus.ACTIVE}}</option>
            <option [value]="noteStatus.ARCHIVED">{{noteStatus.ARCHIVED}}</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Content Textarea -->
    <div class="mb-6">
      <label for="content" class="floating-label block mb-2 text-sm font-medium text-black">Content</label>
      <div class="input-field rounded-xl">
        <textarea id="content"
                  name="content"
                  rows="8"
                  formControlName="content"
                  class="w-full p-4 text-black text-sm bg-transparent border-0 focus:outline-none resize-none"
                  placeholder="Write your thoughts here..."
                  required></textarea>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="flex justify-center">
      <button type="submit"
              class="submit-button px-8 py-3 text-white font-semibold rounded-xl cursor-pointer border-0
              focus:outline-none focus:ring-4 focus:ring-purple-300">
        ‚ú® Create Note
      </button>
    </div>
  </form>
</div>
